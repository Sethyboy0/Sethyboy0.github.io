<!DOCTYPE html>
<script src="https://code.jquery.com/jquery-3.1.0.js"></script>
<script src="flameScoreCalc.js"></script>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>Flame Score Calculator</title>
  <link rel="stylesheet" href="flameScoreCalc.css">
</head>
<body>
  <div id="everythingWrapper">
  <div id="info">
    <h1>Flame Score Calculator</h1>
    <p>This is a calculator for Scardor's flame score system. You can read more about how it works <a href="https://bit.ly/2zHMInA">here</a> and ask him any questions about it on <a href="https://www.twitch.tv/scardor">Twitch</a> or <a href="https://discord.gg/n9MywuN">Discord</a>.</p>
    <p>Message sethyboy0 on Twitch/Reddit/Discord(Sethyboy0#4396) if anything is broken or annoying or you just wanna say thanks.</p>
  <div id="errorMessage"></div>
    <div>
      <input checked type="radio" name="gameStage" value="late">Late Game</input>
      <input type="radio" name="gameStage" value="end">End Game</input>
    </div>
  </div>
<h2>Your Character</h2>
  <span class="tooltip">?
    <span class="tooltiptext">
      <p>Select your class in the dropdown. If your class isn't there, select your class's main stat. No DA yet.</p>
    </span>
  </span>
<div id="player">
  <div id="statSelection">
    <div>
      <label for="classType"> Class/Main Stat: </label>
      <Select id="classType">
        <optgroup label="Special Classes">
          <Option value="xenon">Xenon</Option>
          <Option value="kanna">Kanna</Option>
          <Option value="memeThief" selected>Shadower/DB/Cadena</Option>
        </optgroup>
        <optgroup label="Normal Classes">
          <Option value="str">Str</Option>
          <Option value="dex">Dex</Option>
          <Option value="int">Int</Option>
          <Option value="luk">Luk</Option>
        </optgroup>
      </Select>
    </div>
  </div>
</div>
<div id="calcWrapper">
  <div id="nonWeapon">
    <h2> Item Flame Calculator </h2>
    <div id="scoreDisplay">
      <span> Flame Score: </span>
      <span id="nonWeapScore">0</span>
    </div>
    <div id="statsInput">
      <div class="input">
        <label for="str"> Str </label>
        <input type="number" id="str">
      </div>
      <div class="input">
        <label for="dex"> Dex </label>
        <input type="number" id="dex">
      </div>
      <div class="input">
        <label for="int"> Int </label>
        <input type="number" id="int">
      </div>
      <div class="input">
        <label for="luk"> Luk </label>
        <input type="number" id="luk">
      </div>
      <div class="input">
        <label for="hp"> HP </label>
        <input type="number" id="hp">
      </div>
      <div class="input">
        <label for="mp"> MP </label>
        <input type="number" id="mp">
      </div>
      <div class="input">
        <label for="wAtt"> W. Att </label>
        <input type="number" id="wAtt">
      </div>
      <div class="input">
        <label for="mAtt"> M. Att </label>
        <input type="number" id="mAtt">
      </div>
      <div class="input">
        <label for="allStat"> All Stat (%) </label>
        <input type="number" id="allStat">
      </div>
    </div>
    <div id="buttons">
      <button onCLick="calcFlameScore()" id="calcBtn">Calculate</button>
      <button onCLick="resetNumbers()" id="resetBtn">Reset</button>
    </div>
  </div>
  <div id="weaponFlameTier">
    <h2>Weapon Flame Tier</h2>
    <div id="tierDisplay">
      <div id="weapTierWrapper">
        <span> Tier: </span>
        <span id="weapTier">0</span>
      </div>
      <div>Attack flame tiers: </div>
      <div>
        <table>
          <tr>
            <th>1</th>
            <th>2</th>
            <th>3</th>
            <th>4</th>
            <th>5</th>
            <th>6</th>
            <th>7</th>
          </tr>
          <tr>
            <td id="wt0">0</td>
            <td id="wt1">0</td>
            <td id="wt2">0</td>
            <td id="wt3">0</td>
            <td id="wt4">0</td>
            <td id="wt5">0</td>
            <td id="wt6">0</td>
          </tr>
        </table>
      </div>
    </div>
    <div id="weaponTierInputs">
      <div class="check">
        <label for="flameAdvantage"> Flame advantaged? </label>
        <input type="checkbox" id="flameAdvantage">
      </div>
      <div class="input">
        <label for="levelRange"> Weapon Level </label>
        <Select id="levelRange">
          <Option value="1">0-39</Option>
          <Option value="2">40-79</Option>
          <Option value="3">80-119</Option>
          <Option value="4">120-159</Option>
          <Option value="5" selected>160-199</Option>
          <Option value="6">200-239</Option>
          <Option value="7">240-275</Option>
        </Select>
      </div>
      <div class="input">
        <label for="baseAttack"> Base Attack </label>
        <input id="baseAttack">
      </div>
      <div class="input">
        <label for="flameAttack"> Attack Flame </label>
        <input id="flameAttack">
      </div>
      <div>
        <button onClick="onWeaponFlameBtnClick()" id="calcWeaponFlameBtn">Calculate</button>
        <button onClick="onClearWeaponFlame()" id="clearWeaponFlameBtn">Clear</button>
      </div>
    </div>
  </div>
</div>
<div class="yourItems">
  <h2>Your Items</h2>
  <span class="tooltip">?
    <span class="tooltiptext">
      <p>Keep track of your items here to easily compare them.</p>
      <p>Click save to save the contents of the item flame calculator into the card.
        Click edit to load the item back into the calculator so you can change it.
      I'm sure you can figure out what clear does.</p>
    </span>
  </span>
  <div id="itemCards">
  </div>
  <div id="cardAmountButtons">
        <button onClick="onAddCardsClick()" id="addCardsBtn">+</button>
        <button onClick="onRemoveCardsClick()" id="removeCardsBtn">-</button>
  </div>
  <div class="itemCardTemplate">
    <input type="text" placeholder="Enter a name" class="itemName">
    <div><span>Score: </span><span class="js-score">0</span></div>
    <button class="saveButton">Save</button>
    <div class="bottomButtons">
      <button class="editButton">Edit</button>
      <button class="clearButton">Clear</button>
    </div>
  </div>
</div>
  </div>

<script id="jsbin-source-css" type="text/css">#everythingWrapper {
  margin: auto;
  width: 590px;
}

#info {
  width: 590px;
}

#scoreDisplay, #tierDisplay {
  margin-bottom: 20px;
}

#errorMessage {
  font-size: 18px;
  font-weight: bold;
}

#nonWeapon {
  width: 240px;
  margin-right: 80px;
}

#weaponFlameTier {
  width: 350px;
}

#calcWrapper {
  display: flex;
  width: fit-content;
}

td, th {
  width: 30px;
}

td, th, table {
  border: 1px ridge black;
  border-collapse: collapse;
}

#tierDisplay {
  height: 100px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}

#scoreDisplay, #weapTierWrapper {
  font-size: 15pt;
}

button {
  display: block;
  margin: 4px 0;
}

.input {
  display: flex;
  justify-content: space-between;
}

#statsInput, #statSelection, #weaponTierInputs {
  width: 224px;
}

#statsInput input {
  width: 120px;
}

#weaponTierInputs input {
  width: 100px;
}

#weaponTierInputs select {
  width: 108px;
}

#weaponTierInputs #flameAdvantage {
  width: 20px;
}

.check {
  width: 220px;  
}

/* Item cards */
#itemCards {
  width: 600px;
  display: flex;
  justify-content: space-evenly;
  flex-wrap: wrap;
}

div.itemCard {
  width: fit-content;
  height: fit-content;
  border: 3px outset grey;
  padding: 4px;
  margin: 4px;
}

.itemName {
  width: 84px;
  margin-bottom: 2px;
}

.bottomButtons {
  display: flex;
  justify-content: space-between;
}

.saveButton {
  width: 100%
}

.bottomButtons button {
  width: 48%;
  padding: 1px;
}

h2 {
  display: inline-block;
}

#cardAmountButtons button {
  display: inline;
  width: 20 px;
}

/* Stolen from https://www.w3schools.com/css/css_tooltip.asp */

/* Tooltip container */
.tooltip {
  position: relative;
  display: inline-block;
  border-bottom: 1px dotted black; /* If you want dots under the hoverable text */
}

/* Tooltip text */
.tooltip .tooltiptext {
  visibility: hidden;
  background-color: #555;
  color: #fff;
  text-align: center;
  padding: 5px 0;
  border-radius: 6px;

  /* Position the tooltip text */
  position: absolute;
  z-index: 1;
  width: 500px;
  top: 100%;
  left: 50%;
  margin-left: -100px;

  /* Fade in tooltip */
  opacity: 0;
  transition: opacity 0.3s;
}

/* Show the tooltip text when you mouse over the tooltip container */
.tooltip:hover .tooltiptext {
  visibility: visible;
  opacity: 1;
}</script>

<script id="jsbin-source-javascript" type="text/javascript">// For Scardor's "flame score" system.
// twitch.tv/scardor and type !flames in the chat
/* jshint esnext: true */

// Made by Sethyboy0
// 
// Further edits by:
//
//
//

//  Changelog:
//
// Sometime: Made it
//
// Some time later: Added weapon flame stuff
//
// Another time: 
//   Added Calculate and Reset buttons
//   Added help text
//   Move weapon flame calculator beside item flame instead of below
//
// Uhh: Weapon flame tier table
//
// I forget when these happened:
//   Moved help text to mouseover on question marks
//   Added item cards at the bottom
//   Removed secondary stat and attack type selection, can just infer it
//   
// July 10th 2020:
//   Added links to flame guide, Discord, and stream
//   Use browser local storage to save class selection.
//
// July 19th 2020:
//   Updated Kanna flame stats: Kanna end game HP/MP is 1/100 instead of 1/70
//
// July 27th 2020:
//   Updated kanna flame stats to account for final m.att vs m.att.
//   lategame 1/70 -> 1/112
//   endgame 1/100 -> 1/190
//
// August 8th 2020: 
//   Made weapon flame inputs save.
//   Added reset button for weapon flame.
//   Added buttons to increase/decrease number of cards:
//      Max is 30 and min is 10.
//      The number is saved in local storage.
//
// October 2nd 2020:
//  Slightly tweaked non-flame advantaged values as wiki values 
//  are off for liberated kaiserium
//      Tier 3 3.625% per level bracket -> 3.626% per level bracket
//
// December 15th 2020:
//  Added my Discord to the contact info.
//  Quality of life improvements:
//    Inputs not related to your class are hidden.
//    Clicking reset sets your focus on the first relevant stat so you can quickly enter another flame.
//    Ditto for changing main stat, changing game stage, editing a saved item card, or saving a new item card.
//    Saving an item card resets the inputs so you can quickly enter the next item.
//    Clearing the weapon flame calc or changing the level focuses the attack input.
//
// December 22nd 2020:
//  Updated contact info section and tried to improve HTML layout to fix an issue someone was having.
//  Added error handling to help people know when shit is broken and what to do.
//
// January 24th 2021:
//   Adjusted CSS to center the calculator.
//
// April 17th 2021:
//   Adjusted contact info again.
//   More tweaks to fix abso katana t7 flame
//       Tier 7 10.246? % (fuck I already forget) -> 10.2487 % 
//       (thanks whoever put that extremely specific value on strategywiki
// August 4th 2021L
//   Update Kanna values:
//     Endgame M.att 



//
// Non-weapon flame score calculator
//

const statInputOrder = [
  "str",
  "dex",
  "int",
  "luk",
  "hp",
  "mp",
  "wAtt",
  "mAtt",
  "allStat"
]

function resetNumbers() {
  $("#str, #dex, #int, #luk, #hp, #mp, #wAtt, #mAtt, #allStat").val("");
  $("#nonWeapScore").text("0");
}

// To copy from.
const ezClap = {
    str: 0,
    dex: 0,
    int: 0,
    luk: 0,
    hp: 0,
    mp: 0,
    wAtt: 0,
    mAtt: 0,
  };

// How much flame score each stat is worth.
const baseStatValues = {
  late: Object.assign({allStat: 8.5}, ezClap),
  end: Object.assign({allStat: 9}, ezClap),
  };

// How much certain stats are worth based on game stage.
const scoreByStage = {
  late: {
    secondary: 0.125,
    attack: 4,
  },
  end: {
    secondary: 0.10,
    attack: 3,
  },
}

// Easier just to make xenon its own thing.
const xenonStatValues = {
  late: Object.assign({}, ezClap,
  {
    allStat: 15, 
    str: 1, 
    dex: 1, 
    luk: 1, 
    wAtt: scoreByStage.late.attack,
  }),
  end: Object.assign({}, ezClap,
  {
    allStat: 22, 
    str: 1, 
    dex: 1, 
    luk: 1, 
    wAtt: scoreByStage.end.attack,
  }),
}

const kannaExtraStatValues = {
  late: {
    hp: 1/112,
    mp: 1/112,
  },
  end: {
    hp: 1/150,
    mp: 1/150,
    mAtt: 2.5,
  },
}

const doubleSecondaryAllStatVal = {
  late: 9,
  end: 10,
}

function calcFlameScore(gearStats) {
  const statValues = getStatValues();
  
  let flameScore = 0;
  ["str", "dex", "int", "luk", "hp", "mp", "wAtt", "mAtt", "allStat"].forEach((stat) => {
    flameScore += gearStats[stat] * statValues[stat];
  })
  
  // Round to nicer number.
  flameScore = Math.round((flameScore + 0.00001) * 100) / 100;
  return flameScore;
}

function updateFlameScore() {
  const gearStats = getGearStats();
  
  $('#nonWeapScore').text(calcFlameScore(gearStats));
}

// Map from main stat to appropriate secondary stat.
const secondaryStatMap = {
  str: "dex",
  dex: "str",
  int: "luk",
  luk: "dex",
}

function getStatValues() {
  // Late or end game.
  const gameStage = $('input[name="gameStage"]:checked').val();
  
  // Get character info
  const classType = $('#classType').val();
  
  // Start with some default values (all stat)
  const statValues = Object.assign({}, baseStatValues[gameStage]);
  
  // Check what kind of main stat the class uses.
  let mainStat = "";
  switch (classType) {
    case "xenon":
      // Skip the rest to make it easy.
      return xenonStatValues[gameStage];
    case "kanna":
      mainStat = "int";
      break;
    case "memeThief":
      mainStat = "luk";
      break;
    default:
      mainStat = classType;
      break;
  }
  statValues[mainStat] = 1;
  
  // Figure out secondary stat values
  if (classType === "memeThief") {
      statValues.str = scoreByStage[gameStage].secondary;
      statValues.dex = scoreByStage[gameStage].secondary;
      statValues.allStat = doubleSecondaryAllStatVal[gameStage];
  } else {
    const secondaryStat = secondaryStatMap[mainStat];
    statValues[secondaryStat] = scoreByStage[gameStage].secondary;
  }
  
  // Figure out what attack type the class uses.
  const attackType = mainStat === "int" ? "mAtt": "wAtt";
  statValues[attackType] += scoreByStage[gameStage].attack;
  
  // Bonus Kanna memes.
  if (classType == "kanna") {
    Object.assign(statValues, kannaExtraStatValues[gameStage]);
  }
  
  return statValues;
} //getStatValues()

function getGearStats() {
  return {
    str: $('#str').val(),
    dex: $('#dex').val(),
    int: $('#int').val(),
    luk: $('#luk').val(),
    hp: $('#hp').val(),
    mp: $('#mp').val(),
    wAtt: $('#wAtt').val(),
    mAtt: $('#mAtt').val(),
    allStat: $('#allStat').val(),
  }
}

function setGearStats(stats) {
  $('#str').val(stats.str);
  $('#dex').val(stats.dex);
  $('#int').val(stats.int);
  $('#luk').val(stats.luk);
  $('#hp').val(stats.hp);
  $('#mp').val(stats.mp);
  $('#wAtt').val(stats.wAtt);
  $('#mAtt').val(stats.mAtt);
  $('#allStat').val(stats.allStat);
  updateFlameScore();
}

// Hide inputs for stats that aren't relevant with the given stat values.
function showRelevantStats() {
  const statValues = getStatValues();
  statInputOrder.forEach((stat) => { $(`#${stat}`).toggle(statValues[stat] !== 0);
  })
}

// Focus on the first relevant input for the given stat values.
function focusFirstRelevantInput() {
  const statValues = getStatValues();
  for (let i = 0; i < statInputOrder.length; i++)
  {
    const stat = statInputOrder[i];
    if (statValues[stat] !== 0) {
      $(`#${stat}`).focus();
      break;
    }
  }
}

// ----------------------------------------------
// Weapon Flame Tier calculator
// ----------------------------------------------

// Weapon Flame Tiers
const flameAdvantageWeaponTiers = [
  0.03,
  0.044,
  0.0605,
  0.0799,
  0.102487,
]

const normalWeaponTiers = [
  0.01,
  0.022,
  0.03626,
  0.05325,
  0.073,
  0.088,
  0.1025,
]

// Focus on the weapon attack input.
function focusWeaponAttackInput() {
  $(`#baseAttack`).focus();
}

function updatePossibleFlameTiers() {
  const calcs = calcWeaponFlameTier();  
  const flameAdvantaged = $('#flameAdvantage').is(":checked");
  const tierList = calcs.tierList;

  let indexChange = flameAdvantaged ? 2 : 0;
  if (indexChange === 2) {
    $('#wt0, #wt1').html(" ");
  }
  for (let i = 0; i < tierList.length; i++) {
    $('#wt' + (i + indexChange)).html(tierList[i]);
  }
  
  $('#weapFlameVals').text(tierList);
}

function onWeaponFlameBtnClick() {
  const calcs = calcWeaponFlameTier();
  let flameTier = calcs.flameTier;
  $('#weapTier').text(flameTier);
  updatePossibleFlameTiers();
}

function onClearWeaponFlame() {
  $('#flameAttack, #baseAttack').val("");
  $('#flameAttack, #baseAttack').trigger("change");
  focusWeaponAttackInput();
}

function calcWeaponFlameTier() {
  const flameAdvantaged = $('#flameAdvantage').is(":checked");
  const levelMult = parseInt($('#levelRange').val());
  const baseAttack = parseInt($('#baseAttack').val());
  const flameAttack = parseInt($('#flameAttack').val());
  const baseValues = flameAdvantaged ? flameAdvantageWeaponTiers : normalWeaponTiers;
  
  // Find the right value.
  let flameTier = 0;
  let tierList = [];
  // To display possibilites
  baseValues.forEach((value, index) => {
    const predictedAttack = Math.ceil((levelMult * value) * baseAttack) || 0;
    tierList.push(predictedAttack);
    if (flameAttack == predictedAttack) { flameTier = index + 1; }
  });
  
  // Flame advantaged starts at tier 3.
  if (flameAdvantaged && flameTier != 0) { flameTier += 2; }
  
  return {
    flameTier: flameTier,
    tierList: tierList,
  }
}

// ----------------------------------------------
// Saved Items
// ----------------------------------------------

// To keep track of what the fuck I'm putting into the storage.
const saveDataObject = {
  name: "",
  str: 0,
  dex: 0,
  int: 0,
  luk: 0,
  hp: 0,
  mp: 0,
  wAtt: 0,
  mAtt: 0,
  allStat: 0,
};

var numCards = 10;

function loadNumCards() {
  const storage = window.localStorage;
  const storedCards = storage.getItem("numCards");
  // In case a string gets in there.
  const parsed = parseInt(storedCards);
  if (!isNaN(parsed)) {
    numCards = parsed;
  }
}

function saveNumCards() {
  const storage = window.localStorage;
  storage.setItem("numCards", numCards);
}

function initCards() {
  // Get the number of cards.
  loadNumCards();
  
  // Clone the card
  const firstCard = $('.itemCardTemplate');
  // Make it visible so the clones are lol.
  firstCard.show();

  // Clear container.
  const cardContainer = $('#itemCards');
  cardContainer.empty();
  
  for (let i = 0; i < numCards; i++) {
    const card = firstCard.clone();
    card.removeClass("itemCardTemplate");
    card.addClass("itemCard");
    setupCard(card, i);
    cardContainer.append(card);
  }
  
  // hide original card.
  firstCard.hide();
}

function onAddCardsClick() {
  numCards += 5;
  if (numCards > 30) {
    numCards = 30;
  }
  saveNumCards();
  initCards();
}

function onRemoveCardsClick() {
  numCards -= 5;
  if (numCards < 10) {
    numCards = 10;
  }
  saveNumCards();
  initCards();
}

function makeSaveHandler(card, index) {
  return function() {
    const statFields = getGearStats();
    // Add name and flame score.
    statFields.name = card.find('.itemName').val() || "";
    // Update the card.
    const flameScore = $('#nonWeapScore').text();
    card.find('.js-score').text(flameScore) || 0;
    // Save to local storage.
    window.localStorage.setItem("savedItem" + index, JSON.stringify(statFields));
    // Get user ready for next item
    resetNumbers();
    focusFirstRelevantInput();
  }
}

function makeEditHandler(index) {
  return function() {
    // Load values from storage and set the appropriate fields.
    const stats = JSON.parse(window.localStorage.getItem("savedItem" + index));
    if (!stats) {
      resetNumbers();
      return;
    };
    setGearStats(stats);
    // Get user ready for next item
    focusFirstRelevantInput();
  }
}

function makeClearHandler(card, index) {
  return function() {
    // Clear the local storage.
    const stats = window.localStorage.removeItem("savedItem" + index);
    // Reset card fields.
    card.find('.itemName').val("");
    card.find('.js-score').text(0)
  }
}

// Add click handlers and initial values to card.
function setupCard(card, index) {
  // Check for existing saved data.
  const storage = window.localStorage;
  const existingData = JSON.parse(storage.getItem("savedItem" + index));
  if (existingData) {
    card.find('.itemName').val(existingData.name || "");
    card.find('.js-score').text(calcFlameScore(existingData) || 0)
  }
  
  // Add button handlers.
  const saveBtn = card.find('.saveButton');
  saveBtn.on("click", makeSaveHandler(card, index));
  
  const editBtn = card.find('.editButton');
  editBtn.on("click", makeEditHandler(index));
  
  const clearBtn = card.find('.clearButton');
  clearBtn.on("click", makeClearHandler(card, index));
}

// ----------------------------------------------
// Initialization
// ----------------------------------------------

// Inputs that have their value stored.
  const storedInputs = [
    "classType",
    "flameAdvantage", 
    "levelRange", 
    "baseAttack", 
    "flameAttack"
  ];

function loadFromStorage(inputName) {
  const storage = window.localStorage;
  const inputValue = storage.getItem(inputName);
  if (inputValue && inputValue !== "undefined") {
    $("#"+inputName).val(inputValue);
  }
}

function storeInputChoice(inputName) {
  const storage = window.localStorage;
  const inputValue = $("#"+inputName).val();
  storage.setItem(inputName, inputValue);
}

function storeCheckbox(inputName) {
  const storage = window.localStorage;
  const inputValue = $("#"+inputName).prop("checked");
  storage.setItem(inputName, inputValue);
}

function storeRadio(inputName) {
  const storage = window.localStorage;
  const inputValue = $("input:radio[name='"+inputName+"']:checked").val();
  storage.setItem(inputName, inputValue);
}

function addSaveHandler(inputName) {
  $("#"+inputName).on("change", () => storeInputChoice(inputName));
}

// These inputs don't behave as nice so they get their own function.
function addWeirdSaveHandlers() {
  $("input:radio[name=gameStage]").on("change", () => 
                                      storeRadio("gameStage"));
  
  $("#flameAdvantage").on("change", () => 
                          storeCheckbox("flameAdvantage"));
}

// Checkboxes and radio buttons are weird.
function loadWeirdInputs() {
  const storage = window.localStorage;
  const gameStage = storage.getItem("gameStage");
  if (gameStage && gameStage !== "undefined") {
    $("input:radio[name=gameStage]").val([gameStage]);
  }
 
  const flameAdvantage = storage.getItem("flameAdvantage");
  if (flameAdvantage) {
    $("#flameAdvantage").prop("checked", flameAdvantage === "true");
    updatePossibleFlameTiers();
  }
}

// Combine the two QoL functions
function getReadyForInput() {
  showRelevantStats();
  focusFirstRelevantInput();
}

function initPage() {
  // Load input values;
  storedInputs.forEach(loadFromStorage);
  loadWeirdInputs();
  
  // Add handlers to save input
  storedInputs.forEach(addSaveHandler);
  addWeirdSaveHandlers();
  
  // Add change handlers to the inputs.
  $("#classType, #str, #dex, #int, #luk, #hp, #mp, #wAtt, #mAtt, #allStat, input[name='gameStage']").on("change keyup", updateFlameScore);
  
  // Add QoL handlers.
  $("#classType, input[name='gameStage']").on("change", getReadyForInput);                           $("#resetBtn").on("click", getReadyForInput);
  
  // Reset cards on changes that require recalculating scores.
  $("#classType, input[name='gameStage']").on("change", initCards);
  
  // Weapon flame score stuff
  $('#baseAttack, #levelRange').on('change keyup', updatePossibleFlameTiers);
  $('#levelRange').on('change', focusWeaponAttackInput);
  $('#flameAdvantage').on('click', updatePossibleFlameTiers);
  $('#flameAttack').on('change', onWeaponFlameBtnClick);
  
  initCards();
  showRelevantStats();
}

function handleError(err) {
 var message = "There was an error loading the calculator. Please contact Sethyboy0 and show him this:<br><br>" + err.message; 
  document.getElementById("errorMessage").innerHTML = message;
}

try {
 initPage();
}
catch (err) {
  handleError(err);
}</script></body>
</html>
